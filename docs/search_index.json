[["index.html", "NonParametric Stats 1 Hypothesis Testing", " NonParametric Stats Katherine Wilson 2022-01-19 1 Hypothesis Testing \\[\\begin{equation} X \\sim N(\\mu,\\sigma^2), f(x) = \\frac{1}{\\sqrt{2\\pi\\sigma}}e-\\frac{(x-\\mu)^2}{2\\sigma^2}, F(x) = \\int_{-\\infty}^{x} \\frac{1}{\\sqrt{2\\pi\\sigma}}e\\frac{-(t-\\mu)^2}{2\\sigma^2}dt \\end{equation}\\] Normal Distributions a =0 b=1 lx=100 x=seq(-4,4,length=lx) fx = dnorm(x,a,b) bx = 1 dbx=dnorm(bx,a,b) dbx ## [1] 0.2419707 plot(x,fx, type = &quot;l&quot;, xlab = &quot;x&quot;, ylab = &quot;f(x)&quot;, main = &quot;Normal density functions&quot;, las= 1) dist_2 &lt;- dnorm(x, mean=0, sd=4) dist_3 &lt;- dnorm(x, mean=1, sd=1) dist_4 &lt;- dnorm(x, mean=1, sd =4) lines(x, dist_2, type = &quot;l&quot;, col = &quot;red&quot;) lines(x, dist_3, type = &quot;l&quot;, col = &quot;green&quot;) lines(x, dist_4, type = &quot;l&quot;, col = &quot;blue&quot;) \\[\\begin{equation} F(x) = P(X\\le x) = 1 - P(X&gt;x) \\end{equation}\\] when lower.tail == TRUE, probabiltiies are p[X&lt;x] ## density under the curve dnorm(x=0, mean=0, sd=1) dnorm(0,0,2) dnorm(0,1,1) dnorm(0,1,2) ## probability pnorm(0,0,1) pnorm(0,0,2) pnorm(0,1,1) pnorm(0,1,2) a=0 b=1 lx=100 x=seq(-4,4,length=lx) fx=dnorm(x,a,b) bx=1 dbx=dnorm(bx,a,b) plot(x,fx,type=&quot;l&quot;,lwd=2,xlab=&quot;x&quot;,ylab=&quot;Density&quot;,main=&quot;N(0,1)&quot;,las=1,xaxt=&quot;n&quot;) segments(bx,0,bx,dbx,lty=3) sx=seq(-4,bx,length=lx) polygon(c(sx,rev(sx)),c(dnorm(sx,a,b),rep(0,lx)),density=2,border=NA,lty=3) text(-0.5,0.1,expression(P(X&lt;=z[1-alpha])==1-alpha)) abline(h=0,lty=3) axis(1,at=bx,label=expression(z[1-alpha])) sx=seq(bx,4,length=lx) polygon(c(sx,rev(sx)),c(dnorm(sx,a,b),rep(0,lx)),density=3,border=NA, angle=-45,lty=3) text(2.5,0.1,expression(P(X&gt;z[1-alpha])==alpha)) Power Probability of rejecting \\(H_0\\) when it is true is type I error (falsely reject), aka significance of the test aka \\(\\alpha\\). Probability of not reject H_0 when it is false is a type II error, \\(\\beta\\). Power of test is \\(1-\\beta\\). Confidence Intervals Confidence set with a confidence coefficient of \\(1-\\alpha\\) is the set. Parametric Methods Parametric distributions qith populations \\[\\begin{equation} N(\\mu, \\sigma^2),binomial(n,p) \\end{equation}\\] n=30 x=rnorm(n,mean=0,sd=1) sort(x) ## [1] -2.51015837 -1.24649283 -1.20716096 -1.03415010 -0.84766943 -0.80072051 ## [7] -0.60440065 -0.51095971 -0.47043351 -0.25527351 -0.21983188 -0.21400820 ## [13] -0.18856114 -0.18412240 -0.18174739 0.02340623 0.05257698 0.05565014 ## [19] 0.07084479 0.25880629 0.40780288 0.49474301 0.49916373 0.52306891 ## [25] 0.56389432 0.75675371 0.90002290 0.98592229 1.29774790 1.43946992 xbar=mean(x) sdx=sd(x) One sided H_0 \\[\\begin{equation} H_0 : \\mu = \\mu_0 vs. H_1: \\mu &gt; Mu_0\\\\ T = \\frac{\\sqrt(x-\\mu_0)}{\\sigma} \\sim \\text{t distribution with n-1 degrees of freedom} \\\\ \\text{Reject null if t} &gt; t_{n-1,1-\\alpha} \\\\ \\text{Type I error}: \\alpha = P_{\\mu_o}(T&gt;t_{n-1,1-\\alpha}) \\\\ \\text{Acceptance region} : T \\le t_{n-1,1-\\alpha}\\\\ 1- \\alpha = P_{\\mu_0}(\\frac{\\sqrt{n}(\\bar{X}-\\mu_0)}{\\hat\\sigma}) \\le t_{n-1,1-\\alpha}\\\\ = P_{\\mu_0}(\\bar{X} - t_{n-1,1-\\alpha}\\frac{\\hat\\sigma}{\\sqrt{n}} \\le \\mu_0) \\end{equation}\\] Below, the critical values for alpha of 0.05 is 1.699. Given a sample mean of 1, and our critical test statistic of -6.07, probability in the lower tail is 0.99, so fail to accept the alternative that the true mean is greater than 1. alpha = 0.05 tq = qt(1-alpha, n-1) c(qt(1-alpha, n-1), qt(alpha,n-1, lower.tail = F)) ## [1] 1.699127 1.699127 mu0=1 tstat=sqrt(n)*(xbar-mu0)/sdx;c(tstat,tq,pt(tstat,n-1,lower.tail=F)) ## [1] -7.042911 1.699127 1.000000 xbar-tq*sdx/sqrt(n) ## [1] -0.3300369 t.test(x,alternative=&quot;greater&quot;,mu=mu0) ## ## One Sample t-test ## ## data: x ## t = -7.0429, df = 29, p-value = 1 ## alternative hypothesis: true mean is greater than 1 ## 95 percent confidence interval: ## -0.3300369 Inf ## sample estimates: ## mean of x ## -0.07152722 Testing against sample mean of -1, then the tstat is 5.45, and probability in lower tail is &lt;.05, so accept the alternative that true mean is greater than -1. mu0=-1; tstat=sqrt(n)*(xbar-mu0)/sdx c(tstat,tq,pt(tstat,n-1, lower.tail=F)) ## [1] 6.102646e+00 1.699127e+00 6.011637e-07 xbar-tq*sdx/sqrt(n) ## [1] -0.3300369 t.test(x,alternative=&quot;greater&quot;,mu=mu0) ## ## One Sample t-test ## ## data: x ## t = 6.1026, df = 29, p-value = 6.012e-07 ## alternative hypothesis: true mean is greater than -1 ## 95 percent confidence interval: ## -0.3300369 Inf ## sample estimates: ## mean of x ## -0.07152722 Power \\[\\begin{equation} \\text{Reject null if }\\bar{X} &gt; \\mu_0 + t_{n-1,1-\\alpha}\\frac{\\hat\\sigma}{\\sqrt{n}}\\\\ \\text{Type II error: do not reject null when it is false} \\\\ \\beta = P_{H_1}\\text{do not reject null}\\\\ \\text{Power: the probability of rejecting null when alt is true}\\\\ 1-\\beta = P_{\\mu}(\\bar{X} &gt; \\mu_0 + t_{n-1,1-\\alpha}\\frac{\\hat\\sigma}{\\sqrt{n}}) \\\\ = P_{\\mu}(\\frac{\\sqrt{n}(X-\\mu)}{\\hat\\sigma} &gt; \\frac{\\sqrt{n}(\\mu_0 -\\mu)}{\\hat\\sigma} + t_{n-1,1-\\alpha} \\end{equation}\\] alpha = 0.05 tq = qt(1-alpha, n-1) mu0=1 mu=1.5 tv = sqrt(n)*(mu0-mu)/sdx+tq pt(tv,n-1,lower.tail=F) ## [1] 0.9383509 power.t.test(n,delta = abs(mu0-mu), sd=sdx, type = c(&quot;one.sample&quot;), alternative = &quot;one.sided&quot;) ## ## One-sample t test power calculation ## ## n = 30 ## delta = 0.5 ## sd = 0.8333197 ## sig.level = 0.05 ## power = 0.9410209 ## alternative = one.sided \\[\\begin{equation} t_{n-1,\\beta} = \\frac{\\sqrt{n}(\\mu_0 - \\mu)}{\\hat\\sigma} + t_{n-1,1-\\alpha} n = [\\frac{\\hat\\sigma(t_{n-1,\\beta}-t_{n-1,1-\\alpha})}{\\mu_0-\\mu}]^2 \\end{equation}\\] beta =0.1 tb = qt(beta, n-1) (sdx*(tb-tq)/(mu0-mu))^2 ## [1] 25.1755 power.t.test(power= 0.9, delta = abs(mu0-mu), sd = sdx, type = c(&quot;one.sample&quot;), alternative = &quot;one.sided&quot;) ## ## One-sample t test power calculation ## ## n = 25.2039 ## delta = 0.5 ## sd = 0.8333197 ## sig.level = 0.05 ## power = 0.9 ## alternative = one.sided Two sided H1 \\[\\begin{equation} H_0 : \\mu = \\mu_0 vs. H_1: \\mu &gt; Mu_0\\\\ \\text{Reject null if |T|} &gt; t_{n-1,1-\\frac{\\alpha}{2}} \\\\ \\text{Acceptance region} : \\frac{\\sqrt{n}\\mid{\\bar{X} - \\mu_0}\\mid}{\\hat\\sigma} \\le t_{n-1,1-\\frac{\\alpha}{2}}\\\\ 1- \\alpha = P_{\\mu_0}(\\frac{\\sqrt{n}(\\bar{X}-\\mu_0)}{\\hat\\sigma}) \\le t_{n-1,1-\\frac{\\alpha}{2}}\\\\ = P_{\\mu_0}(\\bar{X} - t_{n-1,1-\\frac{\\alpha}{2}}\\frac{\\hat\\sigma}{\\sqrt{n}} \\le \\mu_0 \\le \\bar{X} + t_{n-1,1-\\frac{\\alpha}{2}}\\frac{\\hat\\sigma}{\\sqrt{n}}) \\\\ \\text{Length of CI} : 2t_{n-1,1-\\frac{\\alpha}{2}}\\frac{\\hat\\sigma}{\\sqrt{n}} \\end{equation}\\] alpha = 0.05 tq = qt(1-alpha/2, n-1) mu0=0 tstat = sqrt(n)*(xbar-mu0)/sdx c(tstat, tq,2*pt(abs(tstat),n-1, lower.tail =F)) ## [1] -0.4701325 2.0452296 0.6417768 xbar+c(-1,1)*tq*sdx/sqrt(n) ## [1] -0.3826939 0.2396395 t.test(x,mu=mu0) ## ## One Sample t-test ## ## data: x ## t = -0.47013, df = 29, p-value = 0.6418 ## alternative hypothesis: true mean is not equal to 0 ## 95 percent confidence interval: ## -0.3826939 0.2396395 ## sample estimates: ## mean of x ## -0.07152722 mu0=1 tstat=sqrt(n)*(xbar-mu0)/sdx c(tstat,tq,2*pt(abs(tstat),n-1,lower.tail = F)) ## [1] -7.042911e+00 2.045230e+00 9.550847e-08 xbar + c(-1,1)*tq*sdx/sqrt(n) ## [1] -0.3826939 0.2396395 t.test(x,mu=mu0) ## ## One Sample t-test ## ## data: x ## t = -7.0429, df = 29, p-value = 9.551e-08 ## alternative hypothesis: true mean is not equal to 1 ## 95 percent confidence interval: ## -0.3826939 0.2396395 ## sample estimates: ## mean of x ## -0.07152722 1.0.1 Power "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
