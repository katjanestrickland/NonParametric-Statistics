[["wilcoxon-rank-sum.html", "3 Wilcoxon rank sum 3.1 Two sample T test 3.2 Test Statistic 3.3 Distribution of W 3.4 Computation 3.5 Example 3.6 Hodges-Lehman Estimate 3.7 Example", " 3 Wilcoxon rank sum Nonparametric test. We have two samples, from two populations (X and Y), and interest is in the difference of the two population means. T.test can be used for one sample and two sample. Parametric Methods assume data is from a standard distribution. These distributions have certain parameters associated. For non-parametric, we do not assume a certain distribution. Instead, use an empirical distribution of the data. Wilcoxon is a nonparametric version of the two sample t test. X and Y must be independent. Alternative hypothesis is that X at a given point t is less than the given distribution of Yâ€¦ in other words, X larger than Y. 3.1 Two sample T test \\[\\begin{equation} X_i \\overset{\\text{iid}}{\\sim} N(\\mu_x, \\sigma^2), i \\le m \\\\ Y_j \\overset{\\text{iid}}{\\sim} N(\\mu_y, \\sigma^2), j \\le n\\\\ X_i \\text{independent} of Y_j\\\\ \\text{A natural estimate of} \\mu_x - \\mu_y is \\bar{X} - \\bar{Y} (MLE) \\\\ \\bar{X} - \\bar{Y} \\sim N(\\mu_x - \\mu_y, \\sigma^2(\\frac{1}{n} + \\frac{1}{m})) \\\\ S_x^2 = \\frac{1}{m-1}\\sum_{i=1}^{m}(X_i - \\bar{X})^2\\\\ S_y^2 = \\frac{1}{n-1}\\sum_{i=1}^{m}(Y_i - \\bar{Y})^2\\\\ S_p^2 = \\frac{\\sum_{i=1}^{m}(X_i-\\bar{x})^2+\\sum_{j=1}^{n}(Y_j-\\bar{Y}^2)}{m+n-2} \\\\ T = \\frac{(\\bar{X} - \\bar{Y})- (\\mu_x-\\mu_y)}{s_p\\sqrt{\\frac{1}{m}+\\frac{1}{n}}} \\sim t_{m+n-2} \\\\ H_o: \\mu_x = \\mu_y vs. h_1: \\mu_x \\ne \\mu_y(\\mu_x &gt; \\mu_y, \\mu_x &lt; \\mu_y) \\end{equation}\\] m=28; n=30; x=rnorm(m,mean=1,sd=1); y=rnorm(n,mean=1.1,sd=1); t.test(x,y) ## ## Welch Two Sample t-test ## ## data: x and y ## t = 0.057394, df = 54.958, p-value = 0.9544 ## alternative hypothesis: true difference in means is not equal to 0 ## 95 percent confidence interval: ## -0.5729310 0.6067143 ## sample estimates: ## mean of x mean of y ## 1.020825 1.003933 3.1.1 Location Shift Model 3.1.2 Rank u=c(-1,0,2); c( median(u), mean(u), rank(u) ); ## [1] 0.0000000 0.3333333 1.0000000 2.0000000 3.0000000 u[3]=100; u ## [1] -1 0 100 c( median(u), mean(u), rank(u)); ## [1] 0 33 1 2 3 u[1]=-200; u ## [1] -200 0 100 c( median(u), mean(u), rank(u)); ## [1] 0.00000 -33.33333 1.00000 2.00000 3.00000 u=c(-1,-1,0,2); rank(u); #?rank ## [1] 1.5 1.5 3.0 4.0 3.2 Test Statistic 3.3 Distribution of W 3.4 Computation m=4; n=5; mn=m*n c( dwilcox(0,m,n), dwilcox(mn,m,n), 1/choose(m+n,m)) ## [1] 0.007936508 0.007936508 0.007936508 u=0:mn; plot(u, dwilcox(u,m,n),type=&quot;h&quot;,las=1) 3.5 Example x=c(0.80, 0.83, 1.89, 1.04, 1.45, 1.38, 1.91, 1.64, 0.73, 1.46); y=c(1.15, 0.88, 0.90, 0.74, 1.21); oxy=outer(x,y,function(u,v){(u&gt;v)*1}) u=sum(oxy); u ## [1] 35 pwilcox(u-1,length(x),length(y),lower.tail=F) ## [1] 0.1272061 wilcox.test(x, y, alternative = &quot;g&quot;,conf.int=T); ## ## Wilcoxon rank sum exact test ## ## data: x and y ## W = 35, p-value = 0.1272 ## alternative hypothesis: true location shift is greater than 0 ## 95 percent confidence interval: ## -0.08 Inf ## sample estimates: ## difference in location ## 0.305 3.6 Hodges-Lehman Estimate xy=outer(x,y,&quot;-&quot;); median(xy) ## [1] 0.305 3.7 Example x=c(18.85,16.93,19.29,18.31,17.27,18.64,17.82,19.00,19.58,18.04,17.27, 19.19); y=c(19.23,19.57,19.50,18.64,18.70,19.54,19.04,20.67,20.71, 18.99,19.37,19.06); par(mfrow=c(2,1)); hist(x,xlim=range(x,y)); hist(y,xlim=range(x,y)); wilcox.test(x,y,alternative=&quot;less&quot;,conf.int=T) ## Warning in wilcox.test.default(x, y, alternative = &quot;less&quot;, conf.int = T): cannot ## compute exact p-value with ties ## Warning in wilcox.test.default(x, y, alternative = &quot;less&quot;, conf.int = T): cannot ## compute exact confidence intervals with ties ## ## Wilcoxon rank sum test with continuity correction ## ## data: x and y ## W = 26.5, p-value = 0.004672 ## alternative hypothesis: true location shift is less than 0 ## 95 percent confidence interval: ## -Inf -0.350075 ## sample estimates: ## difference in location ## -1.002781 wilcox.test(x,y,alternative=&quot;less&quot;,conf.int=T,exact=F, correct=T) ## ## Wilcoxon rank sum test with continuity correction ## ## data: x and y ## W = 26.5, p-value = 0.004672 ## alternative hypothesis: true location shift is less than 0 ## 95 percent confidence interval: ## -Inf -0.350075 ## sample estimates: ## difference in location ## -1.002781 wilcox.test(x,y,alternative=&quot;less&quot;,conf.int=T,exact=F, correct=F) ## ## Wilcoxon rank sum test ## ## data: x and y ## W = 26.5, p-value = 0.004293 ## alternative hypothesis: true location shift is less than 0 ## 95 percent confidence interval: ## -Inf -0.3500476 ## sample estimates: ## difference in location ## -1.002781 3.7.1 Kolmogorov Smirnov x=rnorm(50) y=runif(30) # Do x and y come from the same distribution? ks.test(x, y) ## ## Two-sample Kolmogorov-Smirnov test ## ## data: x and y ## D = 0.52, p-value = 3.885e-05 ## alternative hypothesis: two-sided "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
